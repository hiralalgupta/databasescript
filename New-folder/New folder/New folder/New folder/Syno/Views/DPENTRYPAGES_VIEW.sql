CREATE OR REPLACE FORCE VIEW "SNX_IWS2"."DPENTRYPAGES_VIEW" ("CASEID", "CATEGORY", "SUBCATEGORY", "CODENAME", "CODEDESC", "FINALPAGENUMBER", "IS_PAGE_DELETED", "SECTIONNUMBER", "STARTSECTIONNUMBER", "ENDSECTIONNUMBER", 
"DATADATE", "DPENTRYID", "HID", "SEQUENCE", "DATAFIELD1", "DATAFIELD1TYPE", "DATAFIELD1REF", "DATAFIELD1VALUE", "DATAFIELD2", "DATAFIELD2TYPE", "DATAFIELD2REF", "DATAFIELD2VALUE", 
"DATAFIELD3", "DATAFIELD3TYPE", "DATAFIELD3REF", "DATAFIELD3VALUE", "DATAFIELD4", "DATAFIELD4TYPE", "DATAFIELD4REF", "DATAFIELD4VALUE", "DATAFIELD5", "DATAFIELD5TYPE", "DATAFIELD5REF", "DATAFIELD5VALUE", 
"DATAFIELD6", "DATAFIELD6TYPE", "DATAFIELD6REF", "DATAFIELD6VALUE", "DATAFIELD7", "DATAFIELD7TYPE", "DATAFIELD7REF", "DATAFIELD7VALUE", "DATAFIELD8", "DATAFIELD8TYPE", "DATAFIELD8REF", "DATAFIELD8VALUE", 
"DATAFIELD9", "DATAFIELD9TYPE", "DATAFIELD9REF", "DATAFIELD9VALUE", "DATAFIELD10", "DATAFIELD10TYPE", "DATAFIELD10REF", "DATAFIELD10VALUE", "DATAFIELD11", "DATAFIELD11TYPE", "DATAFIELD11REF",
  "DATAFIELD11VALUE", "DATAFIELD12", "DATAFIELD12TYPE", "DATAFIELD12REF", "DATAFIELD12VALUE", "DATAFIELD13", "DATAFIELD13TYPE", "DATAFIELD13REF", "DATAFIELD13VALUE", 
  "DATAFIELD14", "DATAFIELD14TYPE", "DATAFIELD14REF", "DATAFIELD14VALUE", "DATAFIELD15", "DATAFIELD15TYPE", "DATAFIELD15REF", "DATAFIELD15VALUE", 
"DATAFIELD16", "DATAFIELD16TYPE", "DATAFIELD16REF", "DATAFIELD16VALUE", "DATAFIELD17", "DATAFIELD17TYPE", "DATAFIELD17REF", "DATAFIELD17VALUE", 
"DATAFIELD18", "DATAFIELD18TYPE", "DATAFIELD18REF", "DATAFIELD18VALUE", 
"DATAFIELD19", "DATAFIELD19TYPE", "DATAFIELD19REF", "DATAFIELD19VALUE", "DATAFIELD20", "DATAFIELD20TYPE", "DATAFIELD20REF", "DATAFIELD20VALUE", "STATUS", "ISCRITICAL", "CRITICALITY", 
  "ICD10CMCODE", "ICD9CODE", "CPTCODE", "ICD10PCSCODE",  "MIBSEVERITYCODE", "MIBDATECODE", "MIBCODE", "MESHCODE", "ISDELETED", "SUSPENDNOTE", "USERFEEDBACK", 
  "CREATED_TIMESTAMP", "CREATED_USERID", "CREATED_STAGEID", "UPDATED_TIMESTAMP", "UPDATED_USERID", "UPDATED_STAGEID", "DEBIT_VALUE", "CREDIT_VALUE", ISFINAL,
  DATAFIELD21,DATAFIELD21TYPE,DATAFIELD21REF,DATAFIELD21VALUE,DATAFIELD22,DATAFIELD22TYPE,DATAFIELD22REF,DATAFIELD22VALUE,
  DATAFIELD23,DATAFIELD23TYPE,DATAFIELD23REF,DATAFIELD23VALUE,DATAFIELD24,DATAFIELD24TYPE,DATAFIELD24REF,DATAFIELD24VALUE,
  DATAFIELD25,DATAFIELD25TYPE,DATAFIELD25REF,DATAFIELD25VALUE,DATAFIELD26,DATAFIELD26TYPE,DATAFIELD26REF,DATAFIELD26VALUE,
  DATAFIELD27,DATAFIELD27TYPE,DATAFIELD27REF,DATAFIELD27VALUE,DATAFIELD28,DATAFIELD28TYPE,DATAFIELD28REF,DATAFIELD28VALUE,
  DATAFIELD29,DATAFIELD29TYPE,DATAFIELD29REF,DATAFIELD29VALUE,DATAFIELD30,DATAFIELD30TYPE,DATAFIELD30REF,DATAFIELD30VALUE,
  DATAFIELD31,DATAFIELD31TYPE,DATAFIELD31REF,DATAFIELD31VALUE,DATAFIELD32,DATAFIELD32TYPE,DATAFIELD32REF,DATAFIELD32VALUE,
  RXCUI)
AS
  SELECT p.CASEID,
    SUBSTR(code.PATH, instr(code.PATH, '/',          -1, 1) + 1, LENGTH(code.PATH) - instr(code.PATH, '/', -1, 1)) category,
    SUBSTR(code.PATH, instr(code.PATH, '/',          -1, 2) + 1, instr(code.PATH, '/', -1, 1) - instr(code.PATH, '/', -1, 2) - 1) subcategory,
    SUBSTR(code.PATH, 2, instr(code.PATH, '/', 1, 2) - instr(code.PATH, '/', 1, 1) - 1) codename,
    code.CODEDESC,
    P.Finalpagenumber,
    p.isdeleted,
    dpe.STARTSECTIONNUMBER AS SECTIONNUMBER,
    dpe.STARTSECTIONNUMBER,
    dpe.ENDSECTIONNUMBER,
    TRUNC(dpe.DATADATE),
    dpe.DPENTRYID,
    code.HID,
    dpe.SEQUENCE,
    code.DATAFIELD1,
    code.DATAFIELD1TYPE,
    code.DATAFIELD1REF,
    dpe.DATAFIELD1VALUE,
    code.DATAFIELD2,
    code.DATAFIELD2TYPE,
    code.DATAFIELD2REF,
    dpe.DATAFIELD2VALUE,
    code.DATAFIELD3,
    code.DATAFIELD3TYPE,
    code.DATAFIELD3REF,
    dpe.DATAFIELD3VALUE,
    code.DATAFIELD4,
    code.DATAFIELD4TYPE,
    code.DATAFIELD4REF,
    dpe.DATAFIELD4VALUE,
    code.DATAFIELD5,
    code.DATAFIELD5TYPE,
    code.DATAFIELD5REF,
    dpe.DATAFIELD5VALUE,
    code.DATAFIELD6,
    code.DATAFIELD6TYPE,
    code.DATAFIELD6REF,
    dpe.DATAFIELD6VALUE,
    code.DATAFIELD7,
    code.DATAFIELD7TYPE,
    code.DATAFIELD7REF,
    dpe.DATAFIELD7VALUE,
    code.DATAFIELD8,
    code.DATAFIELD8TYPE,
    code.DATAFIELD8REF,
    dpe.DATAFIELD8VALUE,
    code.DATAFIELD9,
    code.DATAFIELD9TYPE,
    code.DATAFIELD9REF,
    dpe.DATAFIELD9VALUE,
    code.DATAFIELD10,
    code.DATAFIELD10TYPE,
    code.DATAFIELD10REF,
    dpe.DATAFIELD10VALUE,
    code.DATAFIELD11,
    code.DATAFIELD11TYPE,
    code.DATAFIELD11REF,
    dpe.DATAFIELD11VALUE,
    code.DATAFIELD12,
    code.DATAFIELD12TYPE,
    code.DATAFIELD12REF,
    dpe.DATAFIELD12VALUE,
    code.DATAFIELD13,
    code.DATAFIELD13TYPE,
    code.DATAFIELD13REF,
    dpe.DATAFIELD13VALUE,
    code.DATAFIELD14,
    code.DATAFIELD14TYPE,
    code.DATAFIELD14REF,
    dpe.DATAFIELD14VALUE,
    code.DATAFIELD15,
    code.DATAFIELD15TYPE,
    code.DATAFIELD15REF,
    dpe.DATAFIELD15VALUE,
    code.DATAFIELD16,
    code.DATAFIELD16TYPE,
    code.DATAFIELD16REF,
    dpe.DATAFIELD16VALUE,
    code.DATAFIELD17,
    code.DATAFIELD17TYPE,
    code.DATAFIELD17REF,
    dpe.DATAFIELD17VALUE,
    code.DATAFIELD18,
    code.DATAFIELD18TYPE,
    code.DATAFIELD18REF,
    dpe.DATAFIELD18VALUE,
    code.DATAFIELD19,
    code.DATAFIELD19TYPE,
    code.DATAFIELD19REF,
    dpe.DATAFIELD19VALUE,
    code.DATAFIELD20,
    code.DATAFIELD20TYPE,
    code.DATAFIELD20REF,
    dpe.DATAFIELD20VALUE,
    dpe.STATUS,
    dpe.ISCRITICAL,
    Dpe.Criticality,
    Dpe.Icd10cmcode,
    Dpe.Icd9code,
    Dpe.Cptcode,
    Dpe.Icd10pcscode,
    Dpe.Mibseveritycode,
    Dpe.Mibdatecode,
    Dpe.Mibcode,
    Dpe.Meshcode,
    dpe.isDeleted,
    dpe.SUSPENDNOTE,
    dpe.USERFEEDBACK,
    dpe.CREATED_TIMESTAMP ,
    dpe.CREATED_USERID ,
    dpe.CREATED_STAGEID ,
    dpe.UPDATED_TIMESTAMP ,
    dpe.UPDATED_USERID ,
    dpe.UPDATED_STAGEID,
    dpe.debit_value,
    dpe.credit_value,
    dpe.isfinal,
    code.DATAFIELD21,
    code.DATAFIELD21TYPE,
    code.DATAFIELD21REF,
    dpe.DATAFIELD21VALUE,
    code.DATAFIELD22,
    code.DATAFIELD22TYPE,
    code.DATAFIELD22REF,
    dpe.DATAFIELD22VALUE,
    code.DATAFIELD23,
    code.DATAFIELD23TYPE,
    code.DATAFIELD23REF,
    dpe.DATAFIELD23VALUE,
    code.DATAFIELD24,
    code.DATAFIELD24TYPE,
    code.DATAFIELD24REF,
    dpe.DATAFIELD24VALUE,
    code.DATAFIELD25,
    code.DATAFIELD25TYPE,
    code.DATAFIELD25REF,
    dpe.DATAFIELD25VALUE,
    code.DATAFIELD26,
    code.DATAFIELD26TYPE,
    code.DATAFIELD26REF,
    dpe.DATAFIELD26VALUE,
    code.DATAFIELD27,
    code.DATAFIELD27TYPE,
    code.DATAFIELD27REF,
    dpe.DATAFIELD27VALUE,
    code.DATAFIELD28,
    code.DATAFIELD28TYPE,
    code.DATAFIELD28REF,
    dpe.DATAFIELD28VALUE,
    code.DATAFIELD29,
    code.DATAFIELD29TYPE,
    code.DATAFIELD29REF,
    dpe.DATAFIELD29VALUE,
    code.DATAFIELD30,
    code.DATAFIELD30TYPE,
    code.DATAFIELD30REF,
    dpe.DATAFIELD30VALUE,
    code.DATAFIELD31,
    code.DATAFIELD31TYPE,
    code.DATAFIELD31REF,
    dpe.DATAFIELD31VALUE,
    code.DATAFIELD32,
    code.DATAFIELD32TYPE,
    code.DATAFIELD32REF,
    dpe.DATAFIELD32VALUE,
    dpe.RXCUI --IWT-198 RxNorm coding for drugs and medication SynIDs
  FROM dpentries dpe,
    pages p,
    MEDICALHIERARCHY_LEAF_LEVEL_V code
  WHERE dpe.PAGEID = p.PAGEID
  AND dpe.HID      = code.HID
  ORDER BY category,
    subcategory,
    codename,
    dpe.datadate,
    p.finalpagenumber,
    Dpe.Startsectionnumber;